P = PRes;
T = TRes;
muO = 0.5;
Bo = 1.5;
/*Testing of the solution to excel--- external radius needs to be changed back to that of project description*/
J = 0.00708*Perm*thickness/ muO / Bo / (log(0.472*1442/rwb*12))*5198/5960;
cout << "------------J--------------------------------------------------------- " << J << endl;
/*-------------------------------------------------------------------------------------------------------------------
----------------------------------------------Solution Gas Oil Ratio-------------------------------------------------
-------------------------------------------------------------------------------------------------------------------*/

gammaG100 = gammaG*(1+.00005912*APIOil*Tsep*log10(Psep/114.7));
Rs = gammaG*pow(((P/18.2 + 1.4)*pow(10,0.0125*APIOil-0.00091*T)),1.2048);

/*-------------------------------------------------------------------------------------------------------------------
----------------------------------------------Bubble Point Pressure--------------------------------------------------
-------------------------------------------------------------------------------------------------------------------*/
if (APIOil <= 30){
	C1 = 0.0362;
	C2 = 1.0937;
	C3 = 25.7240;
}
else{
	C1 = .0178;
	C2 = 1.1870;
	C3 = 23.9310;
}

Pb = pow((Rs / C1 / gammaG / pow(2.71828,C3*APIOil/(T+460))),1/C2);

/*-------------------------------------------------------------------------------------------------------------------
----------------------------------------------IPR USING VOGEL METHOD-------------------------------------------------
-------------------------------------------------------------------------------------------------------------------*/


if (Pwf >= Pb){
	qL = J * (P - Pwf);
}
else{
	qL = J/1.8 *P* (1-0.2*(Pwf/P) - 0.8 * pow((Pwf / P),2));
}


cout << "qL------------------------------------------------------------------------------------------- " << qL << endl;

